;*****************************************************************************************************************************************
; Standard Setting
;*****************************************************************************************************************************************

    #Persistent
    #SingleInstance, IGNORE
    #NoEnv
    #UseHook
    #InstallKeybdHook
    #InstallMouseHook
    #HotkeyInterval, 2000
    #MaxHotkeysPerInterval, 200

    Process, Priority, , Realtime
    SendMode, Input
    SetWorkingDir %A_ScriptDir%
    SetTitleMatchMode, 2
    SetMouseDelay -1
    SetKeyDelay, -1
    SetBatchLines, -1
    CoordMode, Mouse, Screen

;*****************************************************************************************************************************************
; Const
;*****************************************************************************************************************************************

    Global DIR_AHK := RegExReplace(A_AhkPath, "[^\\]+?$")
    Global LONG_PRESS_DELAY := 0.2
    Global DUBL_CLICK_DELAY := 250
    Global KeyFlag := Object()

;*****************************************************************************************************************************************
; Init
;*****************************************************************************************************************************************

    Gosub, MouseApp

    Return

;*****************************************************************************************************************************************
; Function
;*****************************************************************************************************************************************

    ; Check Mouse-Typing Desktop
    checkOnDesktop() {
        vIni := "ini\NoDesktop.ini"
        WinGetClass, vAhkClass, A
        IniRead, vResultClass, %vIni%, AhkClass, %vAhkClass%
        If (vResultClass <> "ERROR") {
            Return False
        }
        WinGet, vAhkExe, ProcessName, A
        IniRead, vResultExe, %vIni%, AhkExe, %vAhkExe%
        If (vResultExe <> "ERROR") {
            Return False
        }
        Return True
    }

;*****************************************************************************************************************************************
; Default Hotkey
;*****************************************************************************************************************************************

    !LWin::Run, % DIR_AHK . "\WindowSpy.ahk"

    ^!Escape::ExitApp

;*****************************************************************************************************************************************
; Include
;*****************************************************************************************************************************************

    #Include include\MouseTyping\MouseTyping_main.ahk
    #Include include\MouseApp\MouseApp_main.ahk